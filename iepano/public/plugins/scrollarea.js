/* krpano 1.18 scrollarea plugin (build 2014-10-17) */
var krpanoplugin=function(){function M(a){return"boolean"==typeof a?a:0<="yesontrue1".indexOf(String(a).toLowerCase())}function W(a){if(a&&m&&X){var c=m.timertick,h=0;0==N&&(N=c);var f=c-N|0;N=c;"wheel"==a.type?h=a.deltaY:"mousewheel"==a.type?h=-a.wheelDelta:"DOMMouseScroll"==a.type&&(h=a.detail);h=-h;500<f?O=1==a.deltaMode||0==h%20?0:1:66>f&&(0==O&&0!=h%40&&6<Math.abs(h))&&(O=1);a.preventDefault();a.stopPropagation();0!=h&&(0==O?h=0>h?-5:5:(h/=20,-10>h?h=-10:10<h&&(h=10)),1==j?P(h*x,0):2==j?P(0,
h*v):3==j&&P(0,h*v))}}function s(a,c,h,f,b){var d=null;b=(!0===b?"remove":"add")+"EventListener";var e=Q.browser.events;if(e.touch&&("down"==c?d=e.touchstart:"move"==c?d=e.touchmove:"up"==c&&(d=e.touchend),Q.ie&&!1==e.mouse&&("over"==c?d=e.pointerover?e.pointerover:"MSPointerOver":"out"==c&&(d=e.pointerout?e.pointerout:"MSPointerOut")),d))a[b](d,h,f);if(e.mouse&&("down"==c?d="mousedown":"move"==c?d="mousemove":"up"==c?d="mouseup":"over"==c?d="mouseover":"out"==c&&(d="mouseout"),d))a[b](d,h,f)}function ca(){if(b){var a=
b.sprite.parentNode;if(a&&(a=a.kobject))a.maskchildren=!0,a.poschanged&&a.updatepluginpos(),Y=a,q=a.pixelwidth,r=a.pixelheight,isNaN(q)&&(q=0),isNaN(r)&&(r=0),B=0<q||0<r}}function E(){d=Number(b.x);e=Number(b.y);isNaN(Z)&&(d=0);isNaN($)&&(e=0)}function F(a){a=void 0===a?!1:a;1==(j&1)?b.x!=d&&(b.x=d,a=!0):d=0;2==(j&2)?b.y!=e&&(b.y=e,a=!0):e=0;if(B&&(R[0]!=t||R[1]!=u))R[0]=t,R[1]=u,a=!0;if(a&&b&&B){a=q-t;var c=r-u,h=d,f=e;isNaN(h)&&(h=0);isNaN(f)&&(f=0);h+=a*n;f+=c*p;b.woverflow=-a;b.hoverflow=-c;b.loverflow=
Math.round((-h+C*a)*x);b.roverflow=Math.round((+h-(1-C)*a)*x);b.toverflow=Math.round((-f+D*c)*v);b.boverflow=Math.round((+f-(1-D)*c)*v);b.onscroll&&m.call(b.onscroll,b)}}function da(a){for(;0<w.length&&!(100>=a-w[0].time);)w.shift()}function G(){ca();var a=String(b.align).toLowerCase();if(""==a||"null"==a)a="lefttop";v=x=1;p=n=0.5;D=C=0;0<=a.indexOf("left")&&(n=C=0,x=1);0<=a.indexOf("top")&&(p=D=0,v=1);0<=a.indexOf("right")&&(C=1,n=0,x=-1);0<=a.indexOf("bottom")&&(D=1,p=0,v=-1)}function ea(a){G();
w=[];if(!1==aa)y=!1;else{s(window,"up",fa,!0);s(window,"move",ga,!0);var c=m.stagescale,b=a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0]:a;a=b.pageX/c;c=b.pageY/c;y=!1;S=a;T=c;return!1}}function ha(a){if((void 0===a.pointerType||4==a.pointerType||"mouse"==a.pointerType)&&ba)if(G(),!1!=B&&(a=r-u,0>q-t||0>a))H=!0,s(b.sprite,"move",ia,!0),s(b.sprite,"out",ja,!0)}function ia(){if(H&&!1==y&&Y){var a=Y.getmouse();U(a.x/q*b.pixelwidth,a.y/r*b.pixelheight,!0)}}function ja(){s(b.sprite,"move",
ia,!0,!0);s(b.sprite,"out",ja,!0,!0);H=!1}function ga(a){var c=m.stagescale,b=a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0]:a,f=b.pageX/c,c=b.pageY/c;if(!1==y&&(j&1&&5<Math.abs(f-S)||j&2&&5<Math.abs(c-T)))z&&(g=k=0,z=!1),null!=l&&(clearInterval(l),l=null),y=!0,H=!1,S=f,T=c,E(),Z=d,$=e;y&&(a=a.timeStamp,da(a),w.push({time:a,x:f,y:c}),d=Z+(f-S)*x,e=$+(c-T)*v,f=-(t-q),a=-(u-r),d+=f*n,e+=a*p,c=1/(1+A*A),d=0<f?d-(d-f*n)*c:d-(0<d?d:d<f?d-f:0)*c,e=0<a?e-(e-a*p)*c:e-(0<e?e:e<a?e-a:0)*c,
d-=f*n,e-=a*p,F());return!1}function fa(a){s(window,"up",fa,!0,!0);s(window,"move",ga,!0,!0);if(y){da(a.timeStamp);if(1<w.length){a=w[0];var c=w[w.length-1],b=c.y-a.y,f=(c.time-a.time)*V;k=(c.x-a.x)/f*x;g=b/f*v}else g=k=0;l=setInterval(I,1E3/60);y=!1}}function ma(){setTimeout(function(){ca();F(!0);null==l&&(l=setInterval(I,1E3/60))},100)}function I(){d+=k;e+=g;k*=J;g*=J;var a=0,c=0,b=-(t-q),f=-(u-r);d+=b*n;e+=f*p;0<b?a=d-b*n:z?a=d-ka:d<b?a=d-b:0<d&&(a=d);0.1>a*a&&(a=0);0<f?c=e-f*p:z?c=e-la:e<f?c=
e-f:0<e&&(c=e);0.1>c*c&&(c=0);d-=b*n;e-=f*p;0==(j&1)&&(k=a=0);0==(j&2)&&(g=c=0);0!=a&&(a*=-1,d+=a*(1-A),k=0>=a*k?k+a*K:a*L,k*=A);0!=c&&(c*=-1,e+=c*(1-A),g=0>=c*g?g+c*K:c*L,g*=A);0==a&&(0==c&&0.05>Math.sqrt(k*k+g*g))&&(z=!1,g=k=0,clearInterval(l),l=null);F()}function U(a,c,b){G();E();if(!1==B)setTimeout(function(){U(a,c,b)},10);else{a=Number(a);isNaN(a)&&(a=0);c=Number(c);isNaN(c)&&(c=0);var f=q-t,g=r-u;a=C*t+a*x;c=D*u+c*v;a*=-1;c*=-1;a+=q/2;0<a&&(a=0);a<f&&(a=f);c+=r/2;0<c&&(c=0);c<g&&(c=g);!0===
b?(z=!0,ka=a,la=c,null==l&&(l=setInterval(I,1E3/60))):(f=-(t-q),g=-(u-r),a=0>f?a-f*n:0,c=0>g?c-g*p:0,d=a,e=c,F())}}function na(a,c){U(a,c,!0)}function oa(){null!=l&&(clearInterval(l),l=null);H=y=!1;w=[];g=k=0;z=!1;E()}function P(a,c){z=!1;a=Number(a);isNaN(a)&&(a=0);c=Number(c);isNaN(c)&&(c=0);G();E();if(!1!=B){var b=q-t,f=r-u,j=!1;0>b&&(d+=b*n,0<a&&0>d?(j=!0,k+=a):0>a&&d>b&&(j=!0,k+=a),d-=b*n);0>f&&(e+=f*p,0<c&&0>e?(j=!0,g+=c):0>c&&e>f&&(j=!0,g+=c),e-=f*p);j&&null==l&&(l=setInterval(I,1E3/60))}}
var m=null,b=null,Q=null,j=3,t=0,u=0,R=[0,0],B=!1,Y=null,q=0,r=0,z=!1,ka=0,la=0,x=1,v=1,n=0,p=0,C=0,D=0,A=1,J=0.95,K=0.08,L=0.15,V=1/15,aa=!0,X=!0,y=!1,S=0,T=0,d=0,e=0,Z=0,$=0,l=null,w=[],k=0,g=0,H=!1,ba=!1;this.registerplugin=function(a,c,d){m=a;b=d;"1.16">m.version?(m.trace(3,"Scrollarea Plugin - too old krpano version (min. version 1.16)"),b=m=null):(Q=m.device,b.registerattribute("direction","all",function(a){a=String(a).toLowerCase();j=0;j|=1*(0<=a.indexOf("h"));j|=2*(0<=a.indexOf("v"));j|=3*
(0<=a.indexOf("all"))},function(){return 3==(j&3)?"all":1==(j&1)?"h":"v"}),b.registerattribute("overscroll",A,function(a){A=0>a?0:1<a?1:a},function(){return A}),b.registerattribute("friction",J,function(a){J=Number(a)},function(){return J}),b.registerattribute("acceleration",K,function(a){K=Number(a)},function(){return K}),b.registerattribute("returnacceleration",L,function(a){L=Number(a)},function(){return L}),b.registerattribute("momentum",V,function(a){V=Number(a)},function(){return V}),b.registerattribute("onscroll",
null),b.registerattribute("woverflow",0),b.registerattribute("hoverflow",0),b.registerattribute("loverflow",0),b.registerattribute("roverflow",0),b.registerattribute("toverflow",0),b.registerattribute("boverflow",0),b.registerattribute("draggable",!0,function(a){aa=M(a)},function(){return aa}),b.registerattribute("mwheel",!0,function(a){X=M(a)},function(){return X}),b.registerattribute("onhover_autoscrolling",!1,function(a){ba=M(a)},function(){return ba}),b.registerattribute("csshardwareacceleration",
"auto"),b.setcenter=U,b.scrolltocenter=na,b.stopscrolling=oa,b.scrollby=P,!0==M(b.csshardwareacceleration)&&(b.sprite.style[Q.browser.css.transform+"Style"]="preserve-3d"),b.sprite.addEventListener("DOMMouseScroll",W,!0),b.sprite.addEventListener("mousewheel",W,!0),b.sprite.addEventListener("wheel",W,!0),s(b.sprite,"down",ea,!0),s(b.sprite,"over",ha,!0),m.set("events["+b.name+"_scrollarea].keep",!0),m.set("events["+b.name+"_scrollarea].onresize",ma))};var N=0,O=0;this.onresize=function(a,c){if(!m)return!1;
t=a;u=c;var b;z=!1;G();E();if(!1==B)b=!1;else{b=q-t;var f=r-u,g=!1;d+=b*n;if(0>b){if(0>d||d>b)g=!0}else 0!=d&&(g=!0);d-=b*n;e+=f*p;if(0>f){if(0>e||e>f)g=!0}else 0!=e&&(g=!0);e-=f*p;g&&null==l&&(l=setInterval(I,1E3/60));b=g}!1==b&&F(!0);return!1};this.unloadplugin=function(){m&&b&&(m.set("events["+b.name+"_scrollarea].name",null),null!=l&&(clearInterval(l),l=null),s(b.sprite,"down",ea,!0,!0),s(b.sprite,"over",ha,!0,!0));m=b=null}};
